generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

type InternContact {
  email String?
  phone String?
}

type InternName {
  display String
  first   String
  last    String
}

type InternResume {
  links InternResumeLinks[]
}

type InternResumeLinks {
  label String
  url   String
}

type MemberName {
  display String
  first   String
  last    String
}

type MemberSocials {
  facebook  String
  github    String
  instagram String
  linkedin  String
  website   String
}

model BoardActivity {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  action    String
  boardId   String   @db.ObjectId
  createdAt DateTime @default(now()) @db.Date
  projectId String?  @db.ObjectId
  target    String
  taskId    String?  @db.ObjectId
  user      String

  board   ProjectBoard? @relation(fields: [boardId], references: [id], onDelete: Cascade)
  project Project?      @relation(fields: [projectId], references: [id])
}

model BoardColumn {
  id      String @id @default(auto()) @map("_id") @db.ObjectId
  boardId String @db.ObjectId
  title   String
  order     Int
  color     String?
  createdAt DateTime @default(now()) @db.Date

  board ProjectBoard @relation(fields: [boardId], references: [id], onDelete: Cascade)
  tasks BoardTask[]

  @@unique([boardId, title])
}

model BoardLabel {
  id        String @id @default(auto()) @map("_id") @db.ObjectId
  boardId   String @db.ObjectId
  name      String
  color     String
  bgColor   String?
  textColor String?

  @@unique([boardId, name])
}

model BoardMember {
  id      String @id @default(auto()) @map("_id") @db.ObjectId
  avatar  String
  boardId String @db.ObjectId
  color   String
  name    String
  role    String
  email   String?

  board ProjectBoard @relation(fields: [boardId], references: [id], onDelete: Cascade)
}

model BoardTask {
  id           String    @id @default(auto()) @map("_id") @db.ObjectId
  attachments  Int       @default(0)
  checklist    Int       @default(0)
  columnId     String    @db.ObjectId
  comments     Int       @default(0)
  createdAt    DateTime  @default(now()) @db.Date
  isArchived   Boolean   @default(false)
  order        Int       @default(0)
  priority     String    @default("Medium")
  title        String
  updatedAt    DateTime  @default(now()) @updatedAt @db.Date
  description  String?
  tag          String?
  tagColor     String?
  dueDate      DateTime? @db.Date
  startDate    DateTime? @db.Date
  endDate      DateTime? @db.Date
  completedAt  DateTime? @db.Date

  column      BoardColumn    @relation(fields: [columnId], references: [id], onDelete: Cascade)
  assignees   TaskAssignee[] @relation("BoardTaskToAssignee")
  taskMembers TaskMember[]   @relation("BoardTaskToMember")
  taskComments TaskComment[] @relation("BoardTaskToComment")
}

model ChecklistItem {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  taskId    String   @db.ObjectId
  text      String
  isChecked Boolean
  order     Int
}

model CloudflareImage {
  id           String   @id @default(auto()) @map("_id") @db.ObjectId
  cloudflareId String   @unique
  createdAt    DateTime @db.Date
  fieldName    String?
  filename     String
  format       String
  isActive     Boolean
  publicUrl    String
  relatedId    String?  @db.ObjectId
  relatedType  String?
  size         Int
  tags         Json?
  updatedAt    DateTime @db.Date
  uploadedBy   String?
  variants     String[]

  @@index([relatedType, relatedId])
  @@index([uploadedBy])
}

model Column {
  id String @id @default(auto()) @map("_id") @db.ObjectId
}

model Company {
  id String @id @default(auto()) @map("_id") @db.ObjectId
}

model ContactMessage {
  id           String   @id @default(auto()) @map("_id") @db.ObjectId
  createdAt    DateTime @db.Date
  date         DateTime @db.Date
  email        String
  handledById  String?
  isStarred    Boolean
  message      String
  name         String
  phone        String
  portfolioUrl String?
  resumeUrl    String?
  source       String
  status       String
  subject      String
  updatedAt    DateTime @db.Date

  @@index([email])
  @@index([status])
}

model Intern {
  id            String        @id @default(auto()) @map("_id") @db.ObjectId
  avatar        String
  contact       InternContact
  coopType      String
  createdAt     DateTime      @db.Date
  faculty       String
  gen           String
  major         String
  name          InternName
  portfolioSlug String        @unique
  resume        InternResume
  status        String
  studentId     String
  university    String
  updatedAt     DateTime      @db.Date

  projectLinks ProjectIntern[]
}

model InternshipPosition {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  createdAt   DateTime @db.Date
  description String
  isOpen      Boolean
  title       String
  updatedAt   DateTime @db.Date
}

model ProjectBoard {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  color       String
  createdAt   DateTime @default(now()) @db.Date
  description String
  name        String   @unique
  updatedAt   DateTime @db.Date
  visibility  String

  columns    BoardColumn[]
  members    BoardMember[]
  activities BoardActivity[]
}

model KanbanColumn {
  id String @id @default(auto()) @map("_id") @db.ObjectId
}

model KanbanTask {
  id String @id @default(auto()) @map("_id") @db.ObjectId
}

model MOU {
  id         String   @id @default(auto()) @map("_id") @db.ObjectId
  faculty    String?
  signedDate DateTime? @db.Date
  university String?

  @@index([university, faculty, signedDate])
}

model MediaAsset {
  id        String  @id @default(auto()) @map("_id") @db.ObjectId
  ownerId   String?
  ownerType String?

  @@index([ownerType, ownerId])
}

model Member {
  id         String        @id @default(auto()) @map("_id") @db.ObjectId
  bio        String
  createdAt  DateTime      @db.Date
  department String
  isActive   Boolean
  name       MemberName
  photo      String
  skills     Json?
  slug       String        @unique
  socials    MemberSocials
  title      String
  updatedAt  DateTime      @db.Date

  projectLinks ProjectMember[]
}

model NewsletterSubscriber {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  createdAt DateTime @db.Date
  email     String   @unique
  source    String

  @@index([createdAt])
}

model Notification {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  boardId   String?
  createdAt DateTime @db.Date

  @@index([boardId])
  @@index([createdAt])
}

model Partner {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  createdAt   DateTime @db.Date
  description String
  logo        String
  name        String
  status      String
  type        String
  updatedAt   DateTime @db.Date
  website     String
}

model PlanBoard {
  id      String  @id @default(auto()) @map("_id") @db.ObjectId
  ownerId String?

  @@index([ownerId])
}

model Project {
  id               String    @id @default(auto()) @map("_id") @db.ObjectId
  color            String
  cover            String
  createdAt        DateTime  @db.Date
  description      String
  endDate          DateTime? @db.Date
  featured         Boolean
  gallery          Json?
  internalProgress Int
  isCustomColor    Boolean
  links            Json?
  slug             String    @unique
  startDate        DateTime? @db.Date
  status           String
  summary          String
  tags             Json?
  techStack        Json?
  title            String
  updatedAt        DateTime  @db.Date

  activities  BoardActivity[]
  memberLinks ProjectMember[]
  internLinks ProjectIntern[]

  @@index([status])
  @@index([featured])
  @@index([title])
}

model ProjectCollaborator {
  id        String @id @default(auto()) @map("_id") @db.ObjectId
  projectId String @db.ObjectId
  userId    String @db.ObjectId

  @@unique([userId, projectId])
}

model ProjectIntern {
  id        String @id @default(auto()) @map("_id") @db.ObjectId
  internId  String @db.ObjectId
  projectId String @db.ObjectId

  project Project @relation(fields: [projectId], references: [id], onDelete: Cascade)
  intern  Intern  @relation(fields: [internId], references: [id], onDelete: Cascade)

  @@unique([projectId, internId])
}

model ProjectMember {
  id        String @id @default(auto()) @map("_id") @db.ObjectId
  memberId  String @db.ObjectId
  projectId String @db.ObjectId

  project Project @relation(fields: [projectId], references: [id], onDelete: Cascade)
  member  Member  @relation(fields: [memberId], references: [id], onDelete: Cascade)

  @@unique([projectId, memberId])
}

model Subscriber {
  id    String @id @default(auto()) @map("_id") @db.ObjectId
  email String @unique
}

model Task {
  id String @id @default(auto()) @map("_id") @db.ObjectId
}

model TaskAssignee {
  id     String @id @default(auto()) @map("_id") @db.ObjectId
  taskId String @db.ObjectId
  userId String @db.ObjectId

  task BoardTask @relation("BoardTaskToAssignee", fields: [taskId], references: [id], onDelete: Cascade)
  user User      @relation("UserToAssignee", fields: [userId], references: [id], onDelete: Cascade)

  @@unique([taskId, userId])
}

model TaskComment {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  taskId    String   @db.ObjectId
  userId    String?  @db.ObjectId
  author    String
  content   String
  createdAt DateTime @default(now()) @db.Date

  task BoardTask @relation("BoardTaskToComment", fields: [taskId], references: [id], onDelete: Cascade)
  user User?      @relation("UserToComment", fields: [userId], references: [id], onDelete: Cascade)
}

model TaskMember {
  id     String @id @default(auto()) @map("_id") @db.ObjectId
  taskId String @db.ObjectId
  userId String @db.ObjectId

  task BoardTask @relation("BoardTaskToMember", fields: [taskId], references: [id], onDelete: Cascade)
  user User      @relation("UserToMember", fields: [userId], references: [id], onDelete: Cascade)

  @@unique([taskId, userId])
}

model User {
  id               String    @id @default(auto()) @map("_id") @db.ObjectId
  avatar           String?
  createdAt        DateTime  @db.Date
  email            String    @unique
  isActive         Boolean
  isVerified       Boolean
  name             String
  passwordHash     String
  phone            String
  position         String
  resetToken       String?
  resetTokenExpire DateTime? @db.Date
  role             String
  tokenExpire      DateTime? @db.Date
  updatedAt        DateTime  @db.Date
  verifyToken      String?

  taskAssignees TaskAssignee[] @relation("UserToAssignee")
  taskMembers   TaskMember[]   @relation("UserToMember")
  taskComments  TaskComment[]  @relation("UserToComment")

  @@index([role])
}

model pageviews {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  createdAt DateTime @db.Date
  ipAddress String
  page      String
  referrer  String?
  sessionId String
  userAgent String
}
